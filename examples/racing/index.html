<!DOCTYPE html>
<!-- Any copyright is dedicated to the Public Domain.
   - http://creativecommons.org/publicdomain/zero/1.0/ -->
<html>
  <head>
    <meta charset="utf-8">
    <title>Racing</title>
    <style>
      body {
        background: #693d22;
      }
      #stage {
        text-align: center;
      }
      #footer {
        font-family: Sans-Serif;
        font-size: x-small;
        text-align: center;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        color: Yellow;
      }
      #footer a {
        color: Yellow;
      }
    </style>

    <script>
      SHUMWAY_ROOT = "../../src/";
    </script>

    <script src="../../lib/DataView.js/DataView.js"></script>
    <script src="../../lib/Kanvas/kanvas.js"></script>
    <script src="../../src/avm2/options.js"></script>

    <script>
      var Option = options.Option;
      var OptionSet = options.OptionSet;
      var coreOptions = new OptionSet("Core Options");
      var systemOptions = new OptionSet("System Options");
      var disassemble = systemOptions.register(new Option("d", "disassemble", "boolean", false, "disassemble"));
      var traceLevel = systemOptions.register(new Option("t", "traceLevel", "number", 0, "trace level"));
    </script>

    <!-- Load SWF Dependencies -->
    <script src="../../src/swf/config.js"></script>
    <script src="../../src/swf/util.js"></script>
    <script src="../../src/swf/swf.js"></script>
    <script src="../../src/swf/types.js"></script>
    <script src="../../src/swf/structs.js"></script>
    <script src="../../src/swf/tags.js"></script>
    <script src="../../src/swf/inflate.js"></script>
    <script src="../../src/swf/stream.js"></script>
    <script src="../../src/swf/templates.js"></script>
    <script src="../../src/swf/generator.js"></script>
    <script src="../../src/swf/handlers.js"></script>
    <script src="../../src/swf/parser.js"></script>
    <script src="../../src/swf/bitmap.js"></script>
    <script src="../../src/swf/button.js"></script>
    <script src="../../src/swf/font.js"></script>
    <script src="../../src/swf/image.js"></script>
    <script src="../../src/swf/label.js"></script>
    <script src="../../src/swf/shape.js"></script>
    <script src="../../src/swf/sound.js"></script>
    <script src="../../src/swf/text.js"></script>
    <script src="../../src/swf/mp3worker.js"></script>

    <!-- Load AVM1 Dependencies -->
    <script src="../../src/avm1/classes.js"></script>
    <script src="../../src/avm1/globals.js"></script>
    <script src="../../src/avm1/stream.js"></script>
    <script src="../../src/avm1/interpreter.js"></script>
    <script src="../../src/swf/embed.js"></script>
    <script src="../../src/swf/renderer.js"></script>

        <!-- Load AVM2 Dependencies -->
    <script src="../../src/avm2/config.js"></script>
    <script src="../../src/avm2/util.js"></script>
    <script src="../../src/avm2/options.js"></script>
    <script src="../../src/avm2/metrics.js"></script>

    <script>
      var Counter = new metrics.Counter(true);
      var FrameCounter = new metrics.Counter(true); 
      var Timer = metrics.Timer;

      window.print = function(s) {
        console.log(s);
      };
    </script>

    <script src="../../src/avm2/constants.js"></script>
    <script src="../../src/avm2/errors.js"></script>
    <script src="../../src/avm2/opcodes.js"></script>
    <script src="../../src/avm2/parser.js"></script>
    <script src="../../src/avm2/analyze.js"></script>
    <script src="../../src/avm2/compiler/lljs/src/estransform.js"></script>
    <script src="../../src/avm2/compiler/lljs/src/escodegen.js"></script>
    <script src="../../src/avm2/compiler/inferrer.js"></script>
    <script src="../../src/avm2/compiler/c4/ir.js"></script>
    <script src="../../src/avm2/compiler/builder.js"></script>
    <script src="../../src/avm2/compiler/c4/looper.js"></script>
    <script src="../../src/avm2/compiler/c4/backend.js"></script>
    <script src="../../src/avm2/domain.js"></script>
    <script src="../../src/avm2/class.js"></script>
    <script src="../../src/avm2/xregexp.js"></script>
    <script src="../../src/avm2/runtime.js"></script>
    <script src="../../src/avm2/xml.js"></script>
    <script src="../../src/avm2/json2.js"></script>
    <script src="../../src/avm2/amf.js"></script>
    <script src="../../src/avm2/proxy.js"></script>
    <script src="../../src/avm2/native.js"></script>
    <script src="../../src/avm2/disassembler.js"></script>
    <script src="../../src/avm2/interpreter.js"></script>
    <script src="../../src/avm2/vm.js"></script>

    <!-- Load Flash Dependencies -->

    <script src="../../src/flash/util.js"></script>
    <!-- Autogenerated flash references: base=../../src/flash/ -->
    <script src="../../src/flash/display/Bitmap.js"></script>
    <script src="../../src/flash/display/BitmapData.js"></script>
    <script src="../../src/flash/display/DisplayObject.js"></script>
    <script src="../../src/flash/display/DisplayObjectContainer.js"></script>
    <script src="../../src/flash/display/FrameLabel.js"></script>
    <script src="../../src/flash/display/Graphics.js"></script>
    <script src="../../src/flash/display/InteractiveObject.js"></script>
    <script src="../../src/flash/display/Loader.js"></script>
    <script src="../../src/flash/display/LoaderInfo.js"></script>
    <script src="../../src/flash/display/MorphShape.js"></script>
    <script src="../../src/flash/display/MovieClip.js"></script>
    <script src="../../src/flash/display/NativeMenu.js"></script>
    <script src="../../src/flash/display/NativeMenuItem.js"></script>
    <script src="../../src/flash/display/Scene.js"></script>
    <script src="../../src/flash/display/Shape.js"></script>
    <script src="../../src/flash/display/SimpleButton.js"></script>
    <script src="../../src/flash/display/Sprite.js"></script>
    <script src="../../src/flash/display/Stage.js"></script>
    <script src="../../src/flash/events/Event.js"></script>
    <script src="../../src/flash/events/EventDispatcher.js"></script>
    <script src="../../src/flash/events/KeyboardEvent.js"></script>
    <script src="../../src/flash/events/MouseEvent.js"></script>
    <script src="../../src/flash/events/TextEvent.js"></script>
    <script src="../../src/flash/events/TimerEvent.js"></script>
    <script src="../../src/flash/external/ExternalInterface.js"></script>
    <script src="../../src/flash/filters/BevelFilter.js"></script>
    <script src="../../src/flash/filters/BitmapFilter.js"></script>
    <script src="../../src/flash/filters/BlurFilter.js"></script>
    <script src="../../src/flash/filters/ColorMatrixFilter.js"></script>
    <script src="../../src/flash/filters/ConvolutionFilter.js"></script>
    <script src="../../src/flash/filters/DisplacementMapFilter.js"></script>
    <script src="../../src/flash/filters/DropShadowFilter.js"></script>
    <script src="../../src/flash/filters/GlowFilter.js"></script>
    <script src="../../src/flash/filters/GradientBevelFilter.js"></script>
    <script src="../../src/flash/filters/GradientGlowFilter.js"></script>
    <script src="../../src/flash/filters/ShaderFilter.js"></script>
    <script src="../../src/flash/geom/ColorTransform.js"></script>
    <script src="../../src/flash/geom/Matrix.js"></script>
    <script src="../../src/flash/geom/Matrix3D.js"></script>
    <script src="../../src/flash/geom/Vector3D.js"></script>
    <script src="../../src/flash/geom/Point.js"></script>
    <script src="../../src/flash/geom/Rectangle.js"></script>
    <script src="../../src/flash/geom/Transform.js"></script>
    <script src="../../src/flash/media/ID3Info.js"></script>
    <script src="../../src/flash/media/Sound.js"></script>
    <script src="../../src/flash/media/SoundChannel.js"></script>
    <script src="../../src/flash/media/SoundMixer.js"></script>
    <script src="../../src/flash/media/SoundTransform.js"></script>
    <script src="../../src/flash/media/StageVideo.js"></script>
    <script src="../../src/flash/media/Video.js"></script>
    <script src="../../src/flash/net/NetConnection.js"></script>
    <script src="../../src/flash/net/NetStream.js"></script>
    <script src="../../src/flash/net/ObjectEncoding.js"></script>
    <script src="../../src/flash/net/LocalConnection.js"></script>
    <script src="../../src/flash/net/Responder.js"></script>
    <script src="../../src/flash/net/SharedObject.js"></script>
    <script src="../../src/flash/net/URLLoader.js"></script>
    <script src="../../src/flash/net/URLRequest.js"></script>
    <script src="../../src/flash/net/URLStream.js"></script>
    <script src="../../src/flash/system/ApplicationDomain.js"></script>
    <script src="../../src/flash/system/Capabilities.js"></script>
    <script src="../../src/flash/system/FSCommand.js"></script>
    <script src="../../src/flash/system/Security.js"></script>
    <script src="../../src/flash/system/SecurityDomain.js"></script>
    <script src="../../src/flash/system/System.js"></script>
    <script src="../../src/flash/text/Font.js"></script>
    <script src="../../src/flash/text/StaticText.js"></script>
    <script src="../../src/flash/text/TextField.js"></script>
    <script src="../../src/flash/text/TextFormatClass.js"></script>
    <script src="../../src/flash/ui/ContextMenu.js"></script>
    <script src="../../src/flash/ui/ContextMenuItem.js"></script>
    <script src="../../src/flash/ui/Keyboard.js"></script>
    <script src="../../src/flash/ui/Mouse.js"></script>
    <script src="../../src/flash/utils/Dictionary.js"></script>
    <script src="../../src/flash/utils/Timer.js"></script>
    <script src="../../src/flash/accessibility/Accessibility.js"></script>
    <!-- Autogenerated flash references end -->
    <script src="../../src/flash/stubs.js"></script>
    <script src="../../src/flash/playerglobal.js"></script>

    <script src="avm2utils.js"></script>
  </head>
  <body>
    <div id="stage"></div>


    <script>
      var SWF_PATH = "race.swf";
      createAVM2(builtinPath, playerGlobalPath, EXECUTION_MODE.INTERPRET, EXECUTION_MODE.COMPILE, function (avm2) {
        function loaded() {}

        new BinaryFileReader(SWF_PATH).readAll(null, function(buffer) {
          if (!buffer) {
            throw "Unable to open the file " + SWF_PATH + ": " + error;
          }
          SWF.embed(buffer, document, document.getElementById("stage"), { onComplete: loaded });
        });
      });
    </script>
    <div id="footer">
     <sup>*</sup>
     The SWF file is the ActionScript game by Remus C. See also <a href="http://www.emanueleferonato.com/2007/05/15/create-a-flash-racing-game-tutorial/">Create a Flash Racing Game Tutorial</a> by Emanuele Feronato.
    </div>
  </body>
</html>
